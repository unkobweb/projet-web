"use strict";var admin=new Vue({el:"#admin",data:{},methods:{},created:function(){var ne=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];function le(e){for(var r=[],a=[],t=(new Date).getDay(),n=0;n<t;n++)r.push(ne[n]),a.push(e[n].sales);r.push(ne[t]),a.push(e[t].sales);for(var l=6;t<l;l--)r.unshift(ne[l]),a.unshift(e[l].sales);return{sortedDays:r,sortedSales:a}}var oe=[{day:"Dimanche",sales:0},{day:"Lundi",sales:0},{day:"Mardi",sales:0},{day:"Mercredi",sales:0},{day:"Jeudi",sales:0},{day:"Vendredi",sales:0},{day:"Samedi",sales:0}],de=[{day:"Dimanche",sales:0},{day:"Lundi",sales:0},{day:"Mardi",sales:0},{day:"Mercredi",sales:0},{day:"Jeudi",sales:0},{day:"Vendredi",sales:0},{day:"Samedi",sales:0}];fetch("/getDashInfo").then(function(e){return e.json()}).then(function(e){console.log(e);var r=!0,a=!1,t=void 0;try{for(var n,l=e.lastOrders[Symbol.iterator]();!(r=(n=l.next()).done);r=!0){var o=n.value,d=parseInt(new Date(o.createdAt).getDay());oe[oe.map(function(e){return e.day}).indexOf(ne[d])].sales+=o.Products.length}}catch(e){a=!0,t=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw t}}var s=document.getElementById("allSales").getContext("2d"),i=(new Chart(s,{type:"doughnut",data:{labels:le(oe).sortedDays,datasets:[{label:"Commandes",backgroundColor:["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)","rgba(255, 159, 64, 0.8)","rgba(231, 76, 60, 0.8)"],borderColor:"rgb(255, 99, 132)",data:le(oe).sortedSales}]}}),!0),u=!1,y=void 0;try{for(var c,f=e.lastOrders[Symbol.iterator]();!(i=(c=f.next()).done);i=!0){var v=c.value,h=parseInt(new Date(v.createdAt).getDay()),b=!0,m=!1,g=void 0;try{for(var S,p=v.Products[Symbol.iterator]();!(b=(S=p.next()).done);b=!0){var w=S.value;de[de.map(function(e){return e.day}).indexOf(ne[h])].sales+=w.price-w.price*(w.discount/100)}}catch(e){m=!0,g=e}finally{try{b||null==p.return||p.return()}finally{if(m)throw g}}}}catch(e){u=!0,y=e}finally{try{i||null==f.return||f.return()}finally{if(u)throw y}}var x=document.getElementById("allMembers").getContext("2d"),D=(new Chart(x,{type:"doughnut",data:{labels:le(de).sortedDays,datasets:[{label:"Commandes",backgroundColor:["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)","rgba(255, 159, 64, 0.8)","rgba(231, 76, 60, 0.8)"],borderColor:"rgb(255, 99, 132)",data:le(de).sortedSales}]}}),document.querySelector("#totalSales")),M=0,C=le(oe).sortedSales,T=!0,L=!1,I=void 0;try{for(var q,H=C[Symbol.iterator]();!(T=(q=H.next()).done);T=!0){M+=q.value}}catch(e){L=!0,I=e}finally{try{T||null==H.return||H.return()}finally{if(L)throw I}}D.innerHTML="Total : ".concat(M," ventes");var O=document.querySelector("#totalMoney"),P=0,V=le(de).sortedSales,J=!0,k=!1,A=void 0;try{for(var B,E=V[Symbol.iterator]();!(J=(B=E.next()).done);J=!0){P+=B.value}}catch(e){k=!0,A=e}finally{try{J||null==E.return||E.return()}finally{if(k)throw A}}O.innerHTML="Total : ".concat(P.toFixed(2)," €");var F=0,j=!0,z=!1,G=void 0;try{for(var K,N=e.allSales[Symbol.iterator]();!(j=(K=N.next()).done);j=!0){F+=K.value.Products.length}}catch(e){z=!0,G=e}finally{try{j||null==N.return||N.return()}finally{if(z)throw G}}var Q=0,R=!0,U=!1,W=void 0;try{for(var X,Y=e.allSales[Symbol.iterator]();!(R=(X=Y.next()).done);R=!0){var Z=X.value,$=!0,_=!1,ee=void 0;try{for(var re,ae=Z.Products[Symbol.iterator]();!($=(re=ae.next()).done);$=!0){var te=re.value;Q+=te.price-te.price*(te.discount/100)}}catch(e){_=!0,ee=e}finally{try{$||null==ae.return||ae.return()}finally{if(_)throw ee}}}}catch(e){U=!0,W=e}finally{try{R||null==Y.return||Y.return()}finally{if(U)throw W}}document.querySelector("#salesTotal").innerHTML="Total des ventes : ".concat(F," ventes"),document.querySelector("#moneyTotal").innerHTML="Total des recettes : ".concat(Q.toFixed(2)," €")})}});